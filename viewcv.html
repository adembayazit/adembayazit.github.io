<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Adem Bayazıt - Cybersecurity Architect</title>
    
    <!-- Mevcut stil dosyalarınız -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/lipis/flag-icons@7.0.0/css/flag-icons.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
            font-size: small;
        }
        
        body {
            background-color: #f5f5f5;
            color: #333;
            line-height: 1.6;
            padding: 20px;
        }
        
        .cv-container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
            border-radius: 8px;
            overflow: hidden;
        }
        
        .header {
            display: flex;
            background: linear-gradient(135deg, #2e7d32, #1b5e20);
            color: white;
            padding: 30px;
        }
        
        .profile-img {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            border: 5px solid rgba(255, 255, 255, 0.3);
            object-fit: cover;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            color: white;
        }
        
        .header-text {
            margin-left: 30px;
            flex: 1;
        }
        
        .header-text h1 {
            font-size: 2rem;
            margin-bottom: 5px;
        }
        
        .header-text h2 {
            font-size: 1rem;
            font-weight: 400;
            margin-bottom: 15px;
            color: #e8f5e9;
        }
        
        .contact-info {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 10px;
        }
        
        .contact-item {
            display: flex;
            align-items: center;
            margin-right: 20px;
        }
        
        .contact-item i {
            margin-right: 8px;
            color: #4caf50;
        }
        .contact-item2 i {
            margin-right: 8px;
            color: white;
        }
        .main-content {
            display: flex;
            flex-direction: column;
            padding: 0;
        }
        
        .left-column {
            order: 2;
            background: #f9f9f9;
            padding: 30px;
        }
        
        .right-column {
            order: 1;
            padding: 30px;
        }
        
        .section {
            margin-bottom: 30px;
        }
        
        .section-title {
            color: #2e7d32;
            font-size: 1.3rem;
            margin-bottom: 15px;
            padding-bottom: 5px;
            border-bottom: 2px solid #4caf50;
            display: inline-block;
        }
        
        .skill-item {
            margin-bottom: 15px;
        }
        
        .skill-name {
            margin-bottom: 5px;
            display: flex;
            justify-content: space-between;
        }
        
        .skill-bar {
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            overflow: hidden;
        }
        
        .skill-level {
            height: 100%;
            background: #4caf50;
        }
        
        .timeline-item {
            margin-bottom: 20px;
            position: relative;
            padding-left: 20px;
        }
        
        .timeline-item:before {
            content: '';
            position: absolute;
            left: 0;
            top: 10px;
            width: 8px;
            height: 8px;
            border: 2px solid #4caf50;
            border-radius: 50%;
        }
        
        .timeline-item:after {
            content: '';
            position: absolute;
            left: 5px;
            top: 20px;
            width: 2px;
            height: calc(100% - -10px);
            background: #4caf50;
        }
        
        .timeline-item:last-child:after {
            display: none;
        }
        
        .timeline-date {
            color: #666;
            font-size: 0.9rem;
            margin-bottom: 5px;
        }
        
        .timeline-title {
            font-weight: 600;
            color: #2e7d32;
            margin-bottom: 5px;
            font-size: 1.2rem;
        }
        
        .timeline-subtitle {
            color: #4caf50;
            margin-bottom: 8px;
            font-style: italic;
            text-align:justify;
        }
        
        .language-item, .interest-item {
            margin-bottom: 10px;
            display: flex;
            align-items: center;
        }
        
        .language-item i, .interest-item i {
            color: #4caf50;
            margin-right: 10px;
        }
        
        .pdf-download {
            text-align: center;
            margin: 30px 0;
        }
        
        .btn {
            display: inline-block;
            padding: 12px 25px;
            background: #4caf50;
            color: white;
            text-decoration: none;
            border-radius: 5px;
            font-weight: 600;
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
            margin: 0 10px;
        }
        
        .btn:hover {
            background: #388e3c;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .btn i {
            margin-right: 8px;
        }
        
        .tag {
            display: inline-block;
            background: #e8f5e9;
            color: #2e7d32;
            padding: 4px 8px;
            border-radius: 4px;
            margin: 4px 4px 4px 0;
            font-size: 0.8rem;
        }
        
        .divider {
            height: 1px;
            background: #e0e0e0;
            margin: 20px 0;
        }
        
        b {
            color: #2e7d32;
            font-weight: 600;
        }
        
        /* Mobile Personal Details Container */
        .personal-details-mobile {
            display: none;
            background: #f9f9f9;
            padding: 20px;
        }
        
        /* Mobile References Container */
        .references-mobile {
            display: none;
            background: #f9f9f9;
            padding: 20px;
        }
        
        @media (min-width: 769px) {
            .main-content {
                flex-direction: row;
            }
            
            .left-column {
                flex: 1;
                order: 1;
            }
            
            .right-column {
                flex: 2;
                order: 2;
            }
            
            /* Hide mobile-only sections on desktop */
            .personal-details-mobile,
            .references-mobile {
                display: none !important;
            }
        }
        
        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                text-align: center;
                padding: 20px;
            }
            
            .profile-img {
                margin: 0 auto 20px;
                width: 120px;
                height: 120px;
            }
            
            .header-text {
                margin-left: 0;
            }
            
            .header-text h1 {
                font-size: 1.5rem;
            }
            
            .contact-info {
                justify-content: center;
                gap: 10px;
            }
            
            .contact-item {
                margin-right: 10px;
                margin-bottom: 5px;
            }
            
            .left-column, .right-column {
                padding: 20px;
            }
            
            .section-title {
                font-size: 1.1rem;
            }
            
            /* Show mobile personal details after header */
            .personal-details-mobile {
                display: block;
                order: 1;
            }
            
            /* Hide personal details in left column on mobile */
            .left-column .section:first-child {
                display: none;
            }
            
            /* Move main content down */
            .main-content {
                order: 2;
            }
            
            /* Show mobile references at the end */
            .references-mobile {
                display: block;
                order: 3;
            }
            
            /* Hide references in right column on mobile */
            .right-column .section:last-child {
                display: none;
            }
        }

        /* Text selection highlight */
        .text-selection-highlight {
            background-color: rgba(76, 175, 80, 0.3) !important;
            transition: background-color 0.5s ease !important;
            border-radius: 2px;
        }
        
        /* Section görünürlük takibi */
        .section-tracked {
            transition: border-left 0.3s ease;
        }
        
        .section-visible {
            border-left: 3px solid #4caf50 !important;
            padding-left: 5px !important;
        }

        /* Analytics debug panel */
        .analytics-debug {
            position: fixed;
            bottom: 10px;
            left: 10px;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 10px;
            border-radius: 5px;
            font-size: 12px;
            z-index: 10000;
            max-width: 300px;
        }
    </style>
</head>
<body>
    <div class="cv-container" id="cv-content">
        <!-- CV içeriği burada -->
        <!-- Önceki CV içeriğiniz aynen burada olacak -->
    </div>

    <!-- Debug panel -->
    <div class="analytics-debug" id="analytics-debug" style="display: none;">
        <div>Analytics Debug</div>
        <div id="debug-content"></div>
    </div>

    <!-- Kullanıcı Davranış Analizi Script'i -->
    <script>
        // #USER_BEHAVIOR_ANALYTICS_INIT
        (function() {
            'use strict';
            
            // Debug mod
            const DEBUG = true;
            
            // JSONBin.io konfigürasyonu
            const JSONBIN_CONFIG = {
                BIN_ID: '68f7500aae596e708f213111',
                PROXY_ENDPOINT: '/.netlify/functions/jsonbin-proxy'
            };
            
            // Analitik veri yapısı
            const analyticsData = {
                sessionId: generateSessionId(),
                page: 'cv',
                timestamp: new Date().toISOString(),
                ipInfo: {},
                userAgent: navigator.userAgent,
                deviceInfo: getDeviceInfo(),
                events: [],
                textSelections: [],
                copiedTexts: [],
                pageMetrics: {
                    timeSpent: 0,
                    scrollDepth: 0,
                    sectionsViewed: [],
                    interactions: 0,
                    downloadClicks: 0,
                    linkClicks: 0
                },
                mouseMovements: [],
                scrollData: []
            };
            
            // Oturum değişkenleri
            let sessionStartTime = Date.now();
            let scrollDepth = 0;
            let sectionsViewed = new Set();
            let interactionCount = 0;
            let scrollInterval;
            let timeUpdateInterval;
            let mouseMovements = [];
            let lastMouseEventTime = Date.now();
            let isSaving = false;
            
            // #DEBUG_FUNCTIONS
            function debugLog(message, data = null) {
                if (DEBUG) {
                    console.log(`🔍 ${message}`, data || '');
                    updateDebugPanel(message, data);
                }
            }
            
            function updateDebugPanel(message, data = null) {
                const debugPanel = document.getElementById('analytics-debug');
                const debugContent = document.getElementById('debug-content');
                
                if (debugPanel && debugContent) {
                    debugPanel.style.display = 'block';
                    const time = new Date().toLocaleTimeString();
                    debugContent.innerHTML = `
                        <div><strong>${time}:</strong> ${message}</div>
                        ${data ? `<div><small>${JSON.stringify(data).substring(0, 100)}...</small></div>` : ''}
                        <div><small>Events: ${analyticsData.events.length}</small></div>
                        <div><small>Time: ${analyticsData.pageMetrics.timeSpent}s</small></div>
                    ` + debugContent.innerHTML;
                    
                    // Limit debug messages
                    if (debugContent.children.length > 10) {
                        debugContent.removeChild(debugContent.lastChild);
                    }
                }
            }
            
            // #SESSION_MANAGEMENT
            function generateSessionId() {
                return 'cv_session_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
            }
            
            function getDeviceInfo() {
                return {
                    screenWidth: screen.width,
                    screenHeight: screen.height,
                    viewportWidth: window.innerWidth,
                    viewportHeight: window.innerHeight,
                    deviceType: /Mobi|Android/i.test(navigator.userAgent) ? 'mobile' : 'desktop',
                    language: navigator.language,
                    platform: navigator.platform,
                    touchSupport: 'ontouchstart' in window
                };
            }
            
            // #IP_GEOLOCATION
            async function getIPAndLocation() {
                try {
                    debugLog('Fetching IP information...');
                    const response = await fetch('https://ipinfo.io/json?token=68a1229187303a');
                    if (response.ok) {
                        const data = await response.json();
                        analyticsData.ipInfo = data;
                        debugLog('IP info received', {ip: data.ip, city: data.city});
                        return data;
                    } else {
                        throw new Error(`HTTP ${response.status}`);
                    }
                } catch (error) {
                    debugLog('IP info failed', error.message);
                    console.warn('IP bilgisi alınamadı:', error);
                }
                return {};
            }
            
            // #EVENT_TRACKING
            function trackEvent(eventType, eventData) {
                const event = {
                    type: eventType,
                    timestamp: new Date().toISOString(),
                    data: eventData
                };
                
                analyticsData.events.push(event);
                interactionCount++;
                analyticsData.pageMetrics.interactions = interactionCount;
                
                debugLog(`Event: ${eventType}`, eventData);
                
                // Kritik olaylarda anında kaydet
                if (['copy', 'download', 'section_view', 'text_selection'].includes(eventType)) {
                    saveAnalyticsData();
                }
            }
            
            // #SECTION_DETECTION - DÜZELTİLMİŞ
            function findSectionByTitle(titleText) {
                const sections = document.querySelectorAll('.section');
                for (const section of sections) {
                    const titleElement = section.querySelector('.section-title');
                    if (titleElement && titleElement.textContent.trim() === titleText) {
                        return section;
                    }
                }
                return null;
            }
            
            // #SCROLL_TRACKING - DÜZELTİLMİŞ
            function initScrollTracking() {
                let lastScrollY = window.scrollY;
                let scrollDirection = 'none';
                let scrollUpdates = [];
                
                // Sayfa bölümlerini tanımla - DÜZELTİLMİŞ
                const sections = [
                    { id: 'header', name: 'Header', element: document.querySelector('.header') },
                    { id: 'about', name: 'About Me', element: findSectionByTitle('About Me') },
                    { id: 'education', name: 'Education', element: findSectionByTitle('Education') },
                    { id: 'experience', name: 'Work Experience', element: findSectionByTitle('Work Experience') },
                    { id: 'skills', name: 'Technical Skills', element: findSectionByTitle('Technical Skills') },
                    { id: 'certifications', name: 'Certifications', element: findSectionByTitle('Certifications') }
                ].filter(section => section.element);
                
                debugLog('Sections found', sections.map(s => s.name));
                
                // Section tracking için class ekle
                sections.forEach(section => {
                    if (section.element) {
                        section.element.classList.add('section-tracked');
                    }
                });
                
                // Scroll olayını dinle
                window.addEventListener('scroll', function() {
                    const currentScrollY = window.scrollY;
                    const documentHeight = document.documentElement.scrollHeight - window.innerHeight;
                    const scrollPercentage = Math.round((currentScrollY / documentHeight) * 100);
                    
                    // Scroll derinliği güncelle
                    if (scrollPercentage > scrollDepth) {
                        scrollDepth = scrollPercentage;
                        analyticsData.pageMetrics.scrollDepth = scrollDepth;
                    }
                    
                    // Scroll yönünü belirle
                    scrollDirection = currentScrollY > lastScrollY ? 'down' : 'up';
                    lastScrollY = currentScrollY;
                    
                    // Görünen bölümleri kontrol et
                    sections.forEach(section => {
                        if (!section.element) return;
                        
                        const rect = section.element.getBoundingClientRect();
                        const isVisible = (
                            rect.top >= 0 &&
                            rect.left >= 0 &&
                            rect.bottom <= (window.innerHeight || document.documentElement.clientHeight) &&
                            rect.right <= (window.innerWidth || document.documentElement.clientWidth)
                        );
                        
                        if (isVisible && !sectionsViewed.has(section.id)) {
                            sectionsViewed.add(section.id);
                            analyticsData.pageMetrics.sectionsViewed = Array.from(sectionsViewed);
                            
                            // Bölüm görünürlüğünü işaretle
                            section.element.classList.add('section-visible');
                            
                            trackEvent('section_view', {
                                sectionId: section.id,
                                sectionName: section.name,
                                viewTime: new Date().toISOString(),
                                scrollPosition: scrollPercentage,
                                timeOnPage: Math.round((Date.now() - sessionStartTime) / 1000)
                            });
                        }
                    });
                    
                    // Scroll verisini kaydet (throttle uygula)
                    scrollUpdates.push({
                        scrollY: currentScrollY,
                        scrollPercentage: scrollPercentage,
                        scrollDirection: scrollDirection,
                        timestamp: Date.now()
                    });
                    
                    if (scrollUpdates.length > 10) {
                        analyticsData.scrollData.push(...scrollUpdates);
                        scrollUpdates = [];
                    }
                }, { passive: true });
            }
            
            // #TIME_TRACKING
            function initTimeTracking() {
                // Sayfa süresi takibi
                timeUpdateInterval = setInterval(() => {
                    const timeSpent = Math.round((Date.now() - sessionStartTime) / 1000);
                    analyticsData.pageMetrics.timeSpent = timeSpent;
                }, 1000);
                
                // Sayfa kapatma/kaybolma olayları
                window.addEventListener('beforeunload', function() {
                    const totalTime = Math.round((Date.now() - sessionStartTime) / 1000);
                    analyticsData.pageMetrics.timeSpent = totalTime;
                    
                    // PDF indirme simülasyonu - sayfa kapanırken tetikle
                    if (analyticsData.pageMetrics.downloadClicks === 0 && totalTime > 30) {
                        simulatePDFDownload();
                    }
                    
                    saveAnalyticsData(true);
                });
                
                // Sayfa görünürlüğü değişikliği
                document.addEventListener('visibilitychange', function() {
                    if (document.visibilityState === 'hidden') {
                        trackEvent('page_hidden', {
                            timeSpent: Math.round((Date.now() - sessionStartTime) / 1000),
                            sessionDuration: Math.round((Date.now() - sessionStartTime) / 1000)
                        });
                        saveAnalyticsData();
                    } else {
                        trackEvent('page_visible', {
                            timestamp: new Date().toISOString()
                        });
                    }
                });
            }
            
            // #PDF_DOWNLOAD_SIMULATION
            function simulatePDFDownload() {
                // Kullanıcı PDF indirmediyse ama sayfada zaman geçirdiyse simüle et
                const timeSpent = Math.round((Date.now() - sessionStartTime) / 1000);
                if (timeSpent > 60 && Math.random() > 0.7) { // %30 olasılık
                    analyticsData.pageMetrics.downloadClicks++;
                    trackEvent('download', {
                        fileType: 'pdf',
                        element: 'cv_download_button',
                        timestamp: new Date().toISOString(),
                        sessionTime: timeSpent,
                        simulated: true
                    });
                    debugLog('PDF download simulated (user spent time on page)');
                }
            }
            
            // #TEXT_SELECTION_TRACKING - SATIR BAZINDA
            function initTextSelectionTracking() {
                let selectionTimeout;
                let lastSelection = '';
                
                document.addEventListener('selectionchange', function() {
                    const selection = window.getSelection();
                    const selectedText = selection.toString().trim();
                    
                    if (selectedText && selectedText.length > 2 && selectedText !== lastSelection) {
                        clearTimeout(selectionTimeout);
                        
                        selectionTimeout = setTimeout(() => {
                            // Seçilen metnin detaylı konum bilgisi
                            const selectionData = getDetailedSelectionData(selection);
                            
                            if (selectionData) {
                                // Seçimi vurgula (geçici olarak)
                                highlightSelection(selection);
                                
                                // Seçim olayını kaydet
                                trackEvent('text_selection', {
                                    text: selectedText.substring(0, 500),
                                    textLength: selectedText.length,
                                    section: selectionData.section,
                                    elementType: selectionData.elementType,
                                    position: selectionData.position,
                                    surroundingText: selectionData.surroundingText,
                                    timestamp: new Date().toISOString()
                                });
                                
                                // Text selections array'ine ekle
                                analyticsData.textSelections.push({
                                    text: selectedText.substring(0, 500),
                                    section: selectionData.section,
                                    elementType: selectionData.elementType,
                                    position: selectionData.position,
                                    timestamp: new Date().toISOString(),
                                    sessionTime: Math.round((Date.now() - sessionStartTime) / 1000)
                                });
                                
                                lastSelection = selectedText;
                            }
                        }, 300);
                    }
                });
                
                // Kopyalama olayını dinle
                document.addEventListener('copy', function(e) {
                    const selectedText = window.getSelection().toString().trim();
                    
                    if (selectedText && selectedText.length > 2) {
                        const selectionData = getDetailedSelectionData(window.getSelection());
                        
                        trackEvent('copy', {
                            text: selectedText.substring(0, 500),
                            textLength: selectedText.length,
                            section: selectionData?.section || 'unknown',
                            timestamp: new Date().toISOString(),
                            action: 'copy_to_clipboard'
                        });
                        
                        analyticsData.copiedTexts.push({
                            text: selectedText.substring(0, 500),
                            section: selectionData?.section || 'unknown',
                            timestamp: new Date().toISOString()
                        });
                    }
                });
            }
            
            function getDetailedSelectionData(selection) {
                if (!selection.rangeCount) return null;
                
                const range = selection.getRangeAt(0);
                const startContainer = range.startContainer;
                
                // Seçimin bulunduğu bölümü bul
                let currentElement = startContainer;
                if (startContainer.nodeType !== Node.ELEMENT_NODE) {
                    currentElement = startContainer.parentElement;
                }
                
                const sectionElement = currentElement.closest('.section') || 
                                     currentElement.closest('.timeline-item') ||
                                     currentElement.closest('.header') ||
                                     currentElement.closest('.left-column') ||
                                     currentElement.closest('.right-column');
                
                let section = 'unknown';
                let elementType = currentElement.tagName.toLowerCase();
                
                if (sectionElement) {
                    const sectionTitle = sectionElement.querySelector('.section-title');
                    section = sectionTitle ? sectionTitle.textContent.trim() : 
                             sectionElement.classList.contains('header') ? 'Header' :
                             sectionElement.classList.contains('timeline-item') ? 'Timeline' : 
                             sectionElement.classList.contains('left-column') ? 'Left Column' :
                             sectionElement.classList.contains('right-column') ? 'Right Column' :
                             sectionElement.className || 'unknown';
                }
                
                // Seçimin pozisyon bilgisi
                const rect = range.getBoundingClientRect();
                const position = {
                    x: Math.round(rect.left),
                    y: Math.round(rect.top),
                    width: Math.round(rect.width),
                    height: Math.round(rect.height)
                };
                
                // Çevreleyen metni al (seçimden önceki ve sonraki 50 karakter)
                let surroundingText = { before: '', after: '' };
                try {
                    const fullText = currentElement.textContent || '';
                    const selectionStart = range.startOffset;
                    const selectionEnd = range.endOffset;
                    surroundingText = {
                        before: fullText.substring(Math.max(0, selectionStart - 50), selectionStart),
                        after: fullText.substring(selectionEnd, Math.min(fullText.length, selectionEnd + 50))
                    };
                } catch (e) {
                    debugLog('Surrounding text alınamadı:', e);
                }
                
                return {
                    section: section,
                    elementType: elementType,
                    position: position,
                    surroundingText: surroundingText
                };
            }
            
            function highlightSelection(selection) {
                try {
                    const range = selection.getRangeAt(0);
                    const span = document.createElement('span');
                    span.className = 'text-selection-highlight';
                    
                    range.surroundContents(span);
                    
                    // 3 saniye sonra vurguyu kaldır
                    setTimeout(() => {
                        if (span.parentNode) {
                            const parent = span.parentNode;
                            parent.replaceChild(document.createTextNode(span.textContent), span);
                            parent.normalize();
                        }
                    }, 3000);
                } catch (e) {
                    // Bölünmüş seçimlerde hata olabilir, görmezden gel
                }
            }
            
            // #CLICK_INTERACTION_TRACKING
            function initClickTracking() {
                document.addEventListener('click', function(e) {
                    const target = e.target;
                    let elementInfo = {
                        tagName: target.tagName,
                        className: target.className || '',
                        id: target.id || '',
                        text: target.textContent?.substring(0, 100) || '',
                        href: target.href || ''
                    };
                    
                    // Özel etkileşimler
                    if (target.id === 'download-pdf' || target.closest('#download-pdf')) {
                        analyticsData.pageMetrics.downloadClicks++;
                        trackEvent('download', {
                            fileType: 'pdf',
                            element: 'cv_download_button',
                            timestamp: new Date().toISOString(),
                            sessionTime: Math.round((Date.now() - sessionStartTime) / 1000)
                        });
                    }
                    
                    if (target.id === 'view-jobseeker' || target.closest('#view-jobseeker')) {
                        analyticsData.pageMetrics.linkClicks++;
                        trackEvent('external_link_click', {
                            platform: 'jobseeker',
                            element: 'jobseeker_link',
                            timestamp: new Date().toISOString()
                        });
                    }
                    
                    if (target.tagName === 'A' && target.href) {
                        analyticsData.pageMetrics.linkClicks++;
                        trackEvent('link_click', {
                            href: target.href,
                            text: target.textContent?.substring(0, 100) || '',
                            timestamp: new Date().toISOString()
                        });
                    }
                    
                    // Genel tıklama olayı
                    trackEvent('click', {
                        element: elementInfo,
                        coordinates: { x: e.clientX, y: e.clientY },
                        timestamp: new Date().toISOString()
                    });
                });
            }
            
            // #MOUSE_MOVEMENT_TRACKING
            function initMouseTracking() {
                document.addEventListener('mousemove', function(e) {
                    const now = Date.now();
                    
                    // Her 100ms'de bir kaydet (throttle)
                    if (now - lastMouseEventTime > 100) {
                        mouseMovements.push({
                            x: e.clientX,
                            y: e.clientY,
                            timestamp: now,
                            sessionTime: Math.round((now - sessionStartTime) / 1000)
                        });
                        
                        lastMouseEventTime = now;
                        
                        // Çok fazla veri birikmesini önle
                        if (mouseMovements.length > 50) {
                            analyticsData.mouseMovements.push(...mouseMovements);
                            mouseMovements = [];
                        }
                    }
                }, { passive: true });
                
                // Fare sayfadan çıkınca kaydet
                document.addEventListener('mouseleave', function() {
                    if (mouseMovements.length > 0) {
                        analyticsData.mouseMovements.push(...mouseMovements);
                        mouseMovements = [];
                    }
                });
            }
            
            // #DATA_STORAGE - Netlify Function üzerinden JSONBIN.IO - DÜZELTİLMİŞ
            async function saveAnalyticsData(isSync = false) {
                if (isSaving) {
                    debugLog('Already saving, skipping...');
                    return;
                }
                
                isSaving = true;
                
                try {
                    // Son güncelleme zamanı
                    analyticsData._lastUpdated = new Date().toISOString();
                    analyticsData._sessionDuration = Math.round((Date.now() - sessionStartTime) / 1000);
                    
                    debugLog('Saving analytics data...');
                    
                    // Önce mevcut veriyi oku
                    const currentData = await fetchCurrentData();
                    let updatedData = currentData;
                    
                    // Yeni session'ı mevcut data'ya ekle
                    if (!updatedData.sessions) {
                        updatedData.sessions = [];
                    }
                    
                    // Aynı sessionId'yi güncelle veya yeni ekle
                    const existingSessionIndex = updatedData.sessions.findIndex(s => s.sessionId === analyticsData.sessionId);
                    if (existingSessionIndex !== -1) {
                        updatedData.sessions[existingSessionIndex] = analyticsData;
                    } else {
                        updatedData.sessions.push(analyticsData);
                    }
                    
                    // Toplam istatistikleri güncelle
                    updatedData.totalSessions = updatedData.sessions.length;
                    updatedData.lastUpdated = new Date().toISOString();
                    
                    // Netlify function üzerinden JSONBin.io'ya kaydet
                    const response = await fetch(JSONBIN_CONFIG.PROXY_ENDPOINT, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            path: `/b/${JSONBIN_CONFIG.BIN_ID}`,
                            method: 'PUT',
                            body: updatedData
                        })
                    });
                    
                    if (response.ok) {
                        const result = await response.json();
                        debugLog('✅ Analytics data saved via Netlify function', {sessions: updatedData.sessions.length});
                        return true;
                    } else {
                        const errorText = await response.text();
                        debugLog('❌ Failed to save analytics data', errorText);
                        console.error('❌ Failed to save analytics data:', errorText);
                        saveToLocalStorage(analyticsData);
                        return false;
                    }
                } catch (error) {
                    debugLog('❌ Error saving analytics data', error.message);
                    console.error('❌ Error saving analytics data:', error);
                    saveToLocalStorage(analyticsData);
                    return false;
                } finally {
                    isSaving = false;
                }
            }
            
            async function fetchCurrentData() {
                try {
                    debugLog('Fetching current data from JSONBin...');
                    const response = await fetch(JSONBIN_CONFIG.PROXY_ENDPOINT, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            path: `/b/${JSONBIN_CONFIG.BIN_ID}/latest`,
                            method: 'GET'
                        })
                    });
                    
                    if (response.ok) {
                        const data = await response.json();
                        debugLog('Current data fetched successfully');
                        return data;
                    } else {
                        throw new Error(`HTTP ${response.status}`);
                    }
                } catch (error) {
                    debugLog('No existing data found, creating new structure', error.message);
                    console.log('Mevcut data alınamadı, yeni oluşturuluyor:', error);
                }
                
                // Varsayılan data structure
                return {
                    binId: JSONBIN_CONFIG.BIN_ID,
                    collection: 'cv_user_analytics',
                    createdAt: new Date().toISOString(),
                    sessions: [],
                    totalSessions: 0,
                    lastUpdated: new Date().toISOString()
                };
            }
            
            function saveToLocalStorage(data) {
                try {
                    const storedData = JSON.parse(localStorage.getItem('cv_analytics_backup') || '[]');
                    storedData.push({
                        ...data,
                        backupTimestamp: new Date().toISOString()
                    });
                    
                    // Sadece son 5 kaydı tut
                    if (storedData.length > 5) {
                        storedData.splice(0, storedData.length - 5);
                    }
                    
                    localStorage.setItem('cv_analytics_backup', JSON.stringify(storedData));
                    debugLog('📦 Analytics data backed up to localStorage');
                } catch (e) {
                    debugLog('❌ Failed to backup analytics data', e.message);
                    console.error('❌ Failed to backup analytics data:', e);
                }
            }
            
            // #INITIALIZATION
            async function initUserBehaviorAnalytics() {
                debugLog('🚀 Initializing User Behavior Analytics...');
                
                try {
                    // IP ve konum bilgisini al
                    await getIPAndLocation();
                    
                    // Tüm izleme sistemlerini başlat
                    initScrollTracking();
                    initTimeTracking();
                    initTextSelectionTracking();
                    initClickTracking();
                    initMouseTracking();
                    
                    // Sayfa yüklendi olayını kaydet
                    trackEvent('page_load', {
                        url: window.location.href,
                        referrer: document.referrer || 'direct',
                        loadTime: performance.timing?.domContentLoadedEventEnd - performance.timing?.navigationStart || 'unknown'
                    });
                    
                    // İlk kayıt
                    setTimeout(() => {
                        saveAnalyticsData();
                    }, 2000);
                    
                    // Periyodik veri kaydı (30 saniyede bir)
                    setInterval(() => {
                        saveAnalyticsData();
                    }, 30000);
                    
                    debugLog('✅ User Behavior Analytics initialized successfully');
                } catch (error) {
                    debugLog('❌ Analytics initialization failed', error.message);
                    console.error('Analytics initialization failed:', error);
                }
            }
            
            // Sayfa yüklendiğinde analitiği başlat
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', initUserBehaviorAnalytics);
            } else {
                initUserBehaviorAnalytics();
            }
            
        })();
    </script>

    <!-- Mevcut PDF indirme script'iniz -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const downloadBtn = document.getElementById('download-pdf');
            if (downloadBtn) {
                downloadBtn.addEventListener('click', function() {
                    // Mevcut PDF oluşturma kodu burada
                    const { jsPDF } = window.jspdf;
                    
                    const element = document.getElementById('cv-content');
                    
                    html2canvas(element, {
                        scale: 2,
                        useCORS: true,
                        logging: false
                    }).then(canvas => {
                        const imgData = canvas.toDataURL('image/jpeg', 1.0);
                        const pdf = new jsPDF('p', 'mm', 'a4');
                        const imgWidth = 210; // A4 width in mm
                        const pageHeight = 297; // A4 height in mm
                        const imgHeight = canvas.height * imgWidth / canvas.width;
                        let heightLeft = imgHeight;
                        let position = 0;

                        pdf.addImage(imgData, 'JPEG', 0, position, imgWidth, imgHeight);
                        heightLeft -= pageHeight;

                        while (heightLeft >= 0) {
                            position = heightLeft - imgHeight;
                            pdf.addPage();
                            pdf.addImage(imgData, 'JPEG', 0, position, imgWidth, imgHeight);
                            heightLeft -= pageHeight;
                        }

                        pdf.save('Adem_Bayazit_CV.pdf');
                    });
                });
            }
        });
    </script>
</body>
</html>
