<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Paneli - adembayazit.com</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* ... Mevcut CSS kodları ... */
        
        /* Karakter sayacı için yeni stil */
        .char-counter {
            position: absolute;
            right: 10px;
            bottom: 10px;
            background: rgba(0, 30, 0, 0.7);
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 0.7rem;
            color: #aaa;
        }
        
        .char-warning {
            color: var(--warning-color);
            font-weight: bold;
        }
        
        .char-danger {
            color: var(--error-color);
            font-weight: bold;
            animation: pulse 1s infinite;
        }
        
        .textarea-container {
            position: relative;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
    </style>
</head>
<body>
    <!-- ... Mevcut HTML yapısı ... -->

    <div class="admin-container">
        <div class="editor-container">
            <h3><i class="fas fa-plus-circle"></i> Yeni Entry Ekle</h3>
            
            <div class="form-group">
                <label for="entryId"><i class="fas fa-hashtag"></i> Entry ID:</label>
                <input type="number" id="entryId" placeholder="Otomatik ID için boş bırakın">
            </div>
            
            <div class="form-group">
                <label for="referenceId"><i class="fas fa-link"></i> Referans ID (opsiyonel):</label>
                <input type="number" id="referenceId" placeholder="Referans ID">
            </div>
            
            <!-- İngilizce İçerik Alanı -->
            <div class="form-group">
                <label for="enContent"><i class="fas fa-language"></i> İçerik (English):</label>
                <div class="editor-toolbar">
                    <button onclick="formatText('enContent', 'bold')" title="Kalın"><i class="fas fa-bold"></i></button>
                    <button onclick="formatText('enContent', 'italic')" title="İtalik"><i class="fas fa-italic"></i></button>
                    <button onclick="formatText('enContent', 'underline')" title="Altı Çizili"><i class="fas fa-underline"></i></button>
                    <button onclick="formatText('enContent', 'quote')" title="Tırnak İşareti"><i class="fas fa-quote-right"></i></button>
                    <button onclick="clearFormatting('enContent')" title="Temizle"><i class="fas fa-eraser"></i></button>
                </div>
                <div class="textarea-container">
                    <textarea id="enContent" placeholder="English content..." oninput="updateCharCounter('enContent', 'en-counter');"></textarea>
                    <div class="char-counter" id="en-counter">0 karakter</div>
                </div>
            </div>
            
            <!-- Türkçe İçerik Alanı -->
            <div class="form-group">
                <label for="trContent"><i class="fas fa-language"></i> İçerik (Türkçe):</label>
                <div class="editor-toolbar">
                    <button onclick="formatText('trContent', 'bold')" title="Kalın"><i class="fas fa-bold"></i></button>
                    <button onclick="formatText('trContent', 'italic')" title="İtalik"><i class="fas fa-italic"></i></button>
                    <button onclick="formatText('trContent', 'underline')" title="Altı Çizili"><i class="fas fa-underline"></i></button>
                    <button onclick="formatText('trContent', 'quote')" title="Tırnak İşareti"><i class="fas fa-quote-right"></i></button>
                    <button onclick="clearFormatting('trContent')" title="Temizle"><i class="fas fa-eraser"></i></button>
                </div>
                <div class="textarea-container">
                    <textarea id="trContent" placeholder="Türkçe içerik..." oninput="updatePreview(); updateCharCounter('trContent', 'tr-counter');"></textarea>
                    <div class="char-counter" id="tr-counter">0 karakter</div>
                </div>
            </div>
            
            <!-- ... Diğer bölümler ... -->
        </div>
        
        <!-- ... Diğer container ... -->
    </div>

    <script>
        // ... Mevcut JS kodları ...
        
        // Yeni entry ekleme fonksiyonu güncellendi
        async function submitEntry() {
            const entryIdInput = document.getElementById('entryId');
            const referenceId = document.getElementById('referenceId').value;
            const enContent = document.getElementById('enContent').value;
            const trContent = document.getElementById('trContent').value;
            const responseEl = document.getElementById('response-message');
            
            responseEl.style.display = 'none';
            
            if (!enContent || !trContent) {
                showMessage('Lütfen tüm içerik alanlarını doldurun!', 'error');
                return;
            }
            
            try {
                // ... Önceki kodlar ...
                
                // Yeni entry oluştur (güncellendi)
                const newEntry = {
                    id: entryId,
                    date: new Date().toISOString(),
                    content: enContent,       // İngilizce içerik
                    content_tr: trContent,    // Türkçe içerik
                    references: referenceId ? [parseInt(referenceId)] : []
                };
                
                // ... JSONBin'e gönderme ...
                
                // Formu temizle (güncellendi)
                entryIdInput.value = '';
                document.getElementById('referenceId').value = '';
                document.getElementById('enContent').value = '';
                document.getElementById('trContent').value = '';
                
                // Karakter sayaçlarını sıfırla
                updateCharCounter('enContent', 'en-counter');
                updateCharCounter('trContent', 'tr-counter');
                
                // ... Diğer işlemler ...
            } catch (error) {
                // ... Hata yönetimi ...
            }
        }
        
        // Edit fonksiyonu güncellendi
        async function editEntry(entryId) {
            try {
                // ... Önceki kodlar ...
                
                // Edit formu oluştur (güncellendi)
                if (!editForm) {
                    editForm = document.createElement('div');
                    editForm.className = 'edit-form';
                    editForm.innerHTML = `
                        <div class="form-group">
                            <label for="edit-en-${entryId}">İçerik (English):</label>
                            <textarea id="edit-en-${entryId}" oninput="updateCharCounter('edit-en-${entryId}', 'edit-en-counter-${entryId}')">${entry.content || ''}</textarea>
                            <div class="char-counter" id="edit-en-counter-${entryId}">${entry.content ? entry.content.length : 0} karakter</div>
                        </div>
                        <div class="form-group">
                            <label for="edit-tr-${entryId}">İçerik (Türkçe):</label>
                            <textarea id="edit-tr-${entryId}" oninput="updateCharCounter('edit-tr-${entryId}', 'edit-tr-counter-${entryId}')">${entry.content_tr || ''}</textarea>
                            <div class="char-counter" id="edit-tr-counter-${entryId}">${entry.content_tr ? entry.content_tr.length : 0} karakter</div>
                        </div>
                        <div class="edit-actions">
                            <button class="save-btn" onclick="saveEntry(${entryId})"><i class="fas fa-save"></i> Kaydet</button>
                            <button class="cancel-btn" onclick="cancelEdit(${entryId})"><i class="fas fa-times"></i> İptal</button>
                        </div>
                    `;
                    targetItem.appendChild(editForm);
                }
                
                // ... Diğer işlemler ...
            } catch (error) {
                // ... Hata yönetimi ...
            }
        }
        
        // Save fonksiyonu güncellendi
        async function saveEntry(entryId) {
            try {
                const enContent = document.getElementById(`edit-en-${entryId}`).value;
                const trContent = document.getElementById(`edit-tr-${entryId}`).value;
                
                if (!enContent || !trContent) {
                    showMessage('Tüm içerik alanları zorunludur!', 'error');
                    return;
                }
                
                // ... Önceki kodlar ...
                
                // Entry'yi güncelle (güncellendi)
                entriesArray[entryIndex] = {
                    ...entriesArray[entryIndex],
                    content: enContent,
                    content_tr: trContent,
                    date: new Date().toISOString()
                };
                
                // ... JSONBin'e gönderme ...
            } catch (error) {
                // ... Hata yönetimi ...
            }
        }
        
        // Karakter sayacı güncelleme fonksiyonu
        function updateCharCounter(textareaId, counterId) {
            const textarea = document.getElementById(textareaId);
            const counter = document.getElementById(counterId);
            if (!textarea || !counter) return;
            
            const charCount = textarea.value.length;
            counter.textContent = `${charCount} karakter`;
            
            // Uyarı renkleri
            counter.className = 'char-counter';
            if (charCount > 250) {
                counter.classList.add('char-warning');
            }
            if (charCount > 500) {
                counter.classList.add('char-danger');
            }
        }
        
        // Sayfa yüklendiğinde karakter sayaçlarını başlat
        window.addEventListener('DOMContentLoaded', () => {
            // ... Diğer kodlar ...
            
            // Karakter sayaçlarını başlat
            updateCharCounter('enContent', 'en-counter');
            updateCharCounter('trContent', 'tr-counter');
        });
    </script>
</body>
</html>