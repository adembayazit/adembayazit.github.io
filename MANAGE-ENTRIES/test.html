<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <title>ImageKit Upload Test</title>
</head>
<body>
  <h2>ImageKit Upload Test</h2>
  <input type="file" id="fileInput" />
  <button onclick="uploadImage()">YÃ¼kle</button>
  <pre id="result"></pre>

<script>
async function uploadImage() {
  const fileInput = document.getElementById("fileInput");
  if (fileInput.files.length === 0) {
    alert("LÃ¼tfen bir dosya seÃ§in.");
    return;
  }

  const file = fileInput.files[0];

  // ðŸ”‘ Netlify functionâ€™dan auth parametrelerini al
  const authRes = await fetch("/.netlify/functions/imagekit-auth");
  const { token, expire, signature, publicKey } = await authRes.json();

  const formData = new FormData();
  formData.append("file", file);
  formData.append("fileName", file.name);
  formData.append("publicKey", publicKey);
  formData.append("signature", signature);
  formData.append("expire", expire);
  formData.append("token", token);

  const res = await fetch("https://upload.imagekit.io/api/v1/files/upload", {
    method: "POST",
    body: formData
  });

  const data = await res.json();
  document.getElementById("result").textContent = JSON.stringify(data, null, 2);
}
</script>
</body>
</html>