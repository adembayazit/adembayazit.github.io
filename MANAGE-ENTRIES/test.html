<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>ImageKit Secure Upload</title>
<style>
  body { font-family: Arial; padding: 20px; }
  #uploadStatus { margin-top: 10px; color: green; }
</style>
</head>
<body>
<h2>ImageKit Upload</h2>
<input type="file" id="fileInput">
<button id="uploadBtn">Upload</button>
<div id="uploadStatus"></div>

<script src="https://unpkg.com/imagekit-javascript/dist/imagekit.min.js"></script>
<script>
const fileInput = document.getElementById('fileInput');
const uploadBtn = document.getElementById('uploadBtn');
const uploadStatus = document.getElementById('uploadStatus');

uploadBtn.addEventListener('click', async () => {
    const file = fileInput.files[0];
    if (!file) {
        alert("Please select a file!");
        return;
    }

    console.log("Selected file:", file);
    console.log("File name:", file.name);

    const imagekit = new ImageKit({
        publicKey: "public_xxxxxxx",  // Netlify env’den gelen public key
        urlEndpoint: "https://ik.imagekit.io/your_imagekit_id",
        authenticationEndpoint: "/.netlify/functions/imagekit-auth"
    });

    try {
        const result = await imagekit.upload({
            file: file,
            fileName: file.name || "default_name.jpg"  // Dosya adı boşsa fallback
        });
        console.log("Upload success:", result);
        uploadStatus.textContent = "Upload successful! URL: " + result.url;
    } catch (err) {
        console.error("Upload error:", err);
        uploadStatus.style.color = "red";
        uploadStatus.textContent = "Upload failed. Check console for details.";
    }
});
</script>
</body>
</html>